"use strict";(globalThis.webpackChunkhtmv_docs=globalThis.webpackChunkhtmv_docs||[]).push([[4803],{2663(e,t,r){r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"getting-started/your-first-api","title":"Your first API","description":"Good job keeping up so far! Next up in our list is being able to create and delete tasks, and for that we\'ll be making our first API!","source":"@site/docs/getting-started/your-first-api.md","sourceDirName":"getting-started","slug":"/getting-started/your-first-api","permalink":"/docs/getting-started/your-first-api","draft":false,"unlisted":false,"editUrl":"https://github.com/fabrisdev/htmv-docs/tree/main/docs/getting-started/your-first-api.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8},"sidebar":"tutorialSidebar","previous":{"title":"What\'s next?","permalink":"/docs/getting-started/whats-next"},"next":{"title":"Features","permalink":"/docs/category/features"}}');var s=r(5656),o=r(5395);const a={sidebar_position:8},i="Your first API",l={},c=[{value:"An example",id:"an-example",level:2},{value:"Error handling",id:"error-handling",level:2},{value:"Back to our project",id:"back-to-our-project",level:2}];function d(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"your-first-api",children:"Your first API"})}),"\n",(0,s.jsx)(t.p,{children:"Good job keeping up so far! Next up in our list is being able to create and delete tasks, and for that we'll be making our first API!"}),"\n",(0,s.jsx)(t.h2,{id:"an-example",children:"An example"}),"\n",(0,s.jsx)(t.p,{children:"Making an API is just like making any other route. For example, let's say we wish to have an endpoint for retrieving the users from your DB. You would do so like this:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"export async function GET() {\n  const users = await fetchUsers() // replace this with however it is done on your DB\n  return users\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["We could also have a ",(0,s.jsx)(t.code,{children:"POST"})," method to add new users onto the DB."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"import type { RouteParams } from 'htmv'\n\nexport async function POST(params: RouteParams) {\n  const { username, email } = params.query;\n  await addUser({ username, email }) // replace this with however it is done on your DB\n  return \"\"\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["And since we don't actually wish to return a body, just a 200 OK response we might aswell use the built-in ",(0,s.jsx)(t.code,{children:"ok()"})," response helper."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"import type { RouteParams } from 'htmv'\nimport { ok } from 'htmv/http'\n\nexport async function POST(params: RouteParams) {\n  const { username, email } = params.query;\n  await addUser({ username, email }) // replace this with however it is done on your DB\n  return ok()\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"error-handling",children:"Error handling"}),"\n",(0,s.jsx)(t.p,{children:"But what if something goes wrong? For example, if the username is less than our required 6 letters long? We can simply do the following:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"import type { RouteParams } from 'htmv'\nimport { ok, badRequest } from 'htmv/http'\n\nexport async function POST(params: RouteParams) {\n  const { username, email } = params.query;\n  if(typeof username === \"string\" && username.length >= 6) {\n    await addUser({ username, email }) // replace this with however it is done on your DB\n    return ok()\n  }\n  return badRequest(\"Username is either not present or is less than 6 characters long\") // returns a 400 BAD REQUEST response\n}\n"})}),"\n",(0,s.jsx)(t.p,{children:"Of course, you're also missing checking for the email, but I'll leave that as your homework."}),"\n",(0,s.jsxs)(t.p,{children:["Finally, if you need your API to appear after ",(0,s.jsx)(t.code,{children:"localhost:3000/api"}),", remember to create a folder named ",(0,s.jsx)(t.code,{children:"api"})," inside the ",(0,s.jsx)(t.code,{children:"routes"})," folder and work your way from there."]}),"\n",(0,s.jsx)(t.h2,{id:"back-to-our-project",children:"Back to our project"}),"\n",(0,s.jsxs)(t.p,{children:["Okay! Now that we learned all this, let's apply it in our project.\nWe could make a new route file inside ",(0,s.jsx)(t.code,{children:"/api/tasks"})," for it, but since this project's only entity are tasks we might aswell just stick to working in our current file\nIf you wish to split it into another route file then go ahead! Just remember to change the URL once we start trying out our API."]})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},5395(e,t,r){r.d(t,{R:()=>a,x:()=>i});var n=r(7140);const s={},o=n.createContext(s);function a(e){const t=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);